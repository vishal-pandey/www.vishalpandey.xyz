<!DOCTYPE html><html><head><title>RGB control</title><meta name='mobile-web-app-capable' content='yes' />
<meta name='viewport' content='width=device-width' /></head><body style='margin: 0px; padding: 0px;'>
<canvas id='colorspace'></canvas>
<button onclick='on()'>On</button>
<button onclick='off()'>Off</button>
<div style='border:1px solid black; width: 100px; height:100px;'>
Control Switch : <p id='onnn'></p>
</div>
</body>
<script type='text/javascript'>
function on() {
	var onoff = 'on';
	document.getElementById('onnn').innerHTML = onoff;
}
function off() {
	var onoff = 'off';
	document.getElementById('onnn').innerHTML = onoff;
}
(function () {
 var canvas = document.getElementById('colorspace');
 var ctx = canvas.getContext('2d');
 function drawCanvas() {
 var colours = ctx.createLinearGradient(0, 0, window.innerWidth, 0);
 for(var i=0; i <= 360; i+=10) {
 colours.addColorStop(i/360, 'hsl(' + i + ', 100%, 50%)');
 }
 ctx.fillStyle = colours;
 ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
 var luminance = ctx.createLinearGradient(0, 0, 0, ctx.canvas.height);
 luminance.addColorStop(0, '#ffffff');
 luminance.addColorStop(0.05, '#ffffff');
 luminance.addColorStop(0.5, 'rgba(0,0,0,0)');
 luminance.addColorStop(0.95, '#000000');
 luminance.addColorStop(1, '#000000');
 ctx.fillStyle = luminance;
 ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
 }
 var eventLocked = false;
 function handleEvent(clientX, clientY) {
 if(eventLocked) {
 return;
 }
 function colourCorrect(v) {
 return Math.round(1023-(v*v)/64);
 }
 var data = ctx.getImageData(clientX, clientY, 1, 1).data;
 var params = [
 'r=' + colourCorrect(data[0]),
 'g=' + colourCorrect(data[1]),
 'b=' + colourCorrect(data[2]),
 'o=' + onoff
 ].join('&');
 var req = new XMLHttpRequest();
 req.open('POST', '?' + params, true);
 req.send();
 eventLocked = true;
 req.onreadystatechange = function() {
 if(req.readyState == 4) {
 eventLocked = false;
 }
 }
 }
 canvas.addEventListener('click', function(event) {
 handleEvent(event.clientX, event.clientY, true);
 }, false);
 canvas.addEventListener('touchmove', function(event){
 handleEvent(event.touches[0].clientX, event.touches[0].clientY);
}, false);
 function resizeCanvas() {
 canvas.width = window.innerWidth;
 canvas.height = window.innerHeight;
 drawCanvas();
 }
 window.addEventListener('resize', resizeCanvas, false);
 resizeCanvas();
 drawCanvas();
 document.ontouchmove = function(e) {e.preventDefault()};
 })();
</script></html>
<style type='text/css'>
	#colorspace{
		width: 400px;
		height: 400px;
	}
</style>